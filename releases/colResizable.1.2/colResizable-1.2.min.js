//colResizable - by Alvaro Prieto Lauroba - MIT & GPL
(function(i){function K(a){var b=a.find(w+"th");b.length||(b=a.find(w+"td"));a.l=b.length;b.each(function(b){var d=i(this),e=i(a.d[n](x+'G"></div>')[0].lastChild);e.t=a;e.i=b;e.c=d;d.w=d[f]();a.g.push(e);a.c.push(d);d[f](d.w).removeAttr(f);if(b<a.l-1)e.mousedown(L)[n](a.o.gripInnerHtml)[n]('<div class="'+g+'"></div>');else e[o]("CRL")[p]("CRG");e.data(g,{i:b,t:a[q](r)})});s(a);a.find("tr:not(:first)").find("td,th").each(function(){i(this).removeAttr(f)})}function s(a){a.d[f](a.w);for(var b,c=0;c<a.l;c++)b=a.c[c],a.g[c].css({left:b.offset()[j]-a.offset()[j]+b.outerWidth()+a.s/2+t,height:a.o.headerOnly?a.c[0].outerHeight():a.outerHeight()})}function y(a,b,c){var d=h.x-h.l,e=a.c[b],a=a.c[b+1],b=e.w+d,d=a.w-d;e[f](b+t);a[f](d+t);if(c)e.w=b,a.w=d}function M(a){if(h){var b=h.t,c=a.pageX-h.L+h.l,d=b.o.minWidth,e=h.i,f=b.o.onDrag,g=b.s*1.5+d+b.b,i=e==b.l-1?b.w-g:b.g[e+1][k]()[j]-b.s-d,d=e?b.g[e-1][k]()[j]+b.s+d:g,c=v.max(d,v.min(i,c));h.x=c;h.css(j,c+t);b.o.liveDrag&&(y(b,e),s(b),f&&(a[z]=b[0],f(a)));return m}}function N(a){A.unbind(B+g).unbind(C+g);i("head :last-child").remove();if(h){var b=h[p](h.t.o.draggingClass).t,c=b.o.onResize;h.x&&(y(b,h.i,1),s(b),c&&(a[z]=b[0],c(a)));h=u}}function L(a){var b=i(this).data(g),c=l[b.t],d=c.g[b.i],e=0;d.L=a.pageX;d.l=d[k]()[j];A.bind(B+g,M).bind(C+g,N);O[n](D+"*{"+E+F+G);d[o](c.o.draggingClass);h=d;if(c.c[b.i].l)for(;e<c.l;e++)a=c.c[e],a.l=m,a.w=a[f]();return m}var A=i(document),D="<style>",G="}</style>",k="position",F="!important;",n="append",j="left",H=":0px"+F,E="cursor:e-resize",O=i("head")[n](D+".CRZ{table-layout:fixed}.CRZ td,.CRZ th{padding-"+j+H+"padding-right"+H+"overflow:hidden}.CRC{height:0px;"+k+":relative}.CRG{margin-left:-5px;"+k+":absolute; z-index:5}.CRG .CRZ{"+k+":absolute;background-color:red;filter:alpha(opacity=1);opacity:0;width:10px;"+E+";height:100%;top:0px}.CRL{"+k+":absolute;width:1px}.CRD{border-left:1px dotted black"+G),u=null,h=u,l=[],P=0,r="id",t="px",g="CRZ",I=parseInt,v=Math,J=i.browser.msie,m=false,B="mousemove.",C="mouseup.",w="tr:first ",f="width",x='<div class="CR',p="removeClass",o="addClass",q="attr",z="currentTarget";i(window).bind("resize."+g,function(){for(a in l){var a=l[a],b=0,c=0;a[p](g);if(a.w!=a[f]()){for(a.w=a[f]();b<a.l;b++)c+=a.c[b].w;for(b=0;b<a.l;b++)a.c[b].css(f,v.round(1E3*a.c[b].w/c)/10+"%").l=1}s(a[o](g))}});i.fn.extend({colResizable:function(a){a=i.extend({draggingClass:"CRD",gripInnerHtml:"",minWidth:15,onDrag:u,onResize:u,liveDrag:m,headerOnly:m,disable:m},a);return this.each(function(){var b=a,c=i(this),d=c[q](r)||g+P++;if(b.disable){if(c=c[q](r),(b=l[c])&&b.is("table"))b[p](g).d.remove(),delete l[c]}else if(c.is("table")&&!l[d])c[o](g)[q](r,d).before(x+'C"/>'),c.o=b,c.g=[],c.c=[],c.w=c[f](),c.d=c.prev(),c.s=I(J?this.cellSpacing||this.currentStyle.borderSpacing:c.css("border-spacing"))||2,c.b=I(J?this.border||this.currentStyle.borderLeftWidth:c.css("border-"+j+"-"+f))||1,l[d]=c,K(c)})}})})(jQuery);